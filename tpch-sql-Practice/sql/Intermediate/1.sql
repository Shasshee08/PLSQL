
SELECT    
    C.C_NAME,
    C.C_CUSTKEY,
    SUM(L.l_extendedprice) AS TOTAL_ORDER_VALUE
FROM 
    CUSTOMER C
    JOIN
    ORDERS O ON C.C_CUSTKEY = O.O_CUSTKEY
JOIN LINEITEM L 
    ON O.O_ORDERKEY=L.L_ORDERKEY
GROUP BY
    C.C_CUSTKEY,C.C_NAME
    ORDER BY
    TOTAL_ORDER_VALUE DESC;